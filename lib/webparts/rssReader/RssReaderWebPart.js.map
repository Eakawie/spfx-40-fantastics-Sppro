{"version":3,"sources":["webparts/rssReader/RssReaderWebPart.ts"],"names":[],"mappings":"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","file":"webparts/rssReader/RssReaderWebPart.js","sourcesContent":["/**\r\n * @file\r\n * RSS Reader Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneTextField,\r\n  PropertyPaneSlider,\r\n  PropertyPaneToggle,\r\n  IWebPartContext\r\n} from '@microsoft/sp-webpart-base';\r\nimport { Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'RssReaderStrings';\r\nimport { IRssReaderWebPartProps } from './IRssReaderWebPartProps';\r\n\r\n//Imports property pane custom fields\r\nimport { PropertyFieldColorPickerMini } from 'sp-client-custom-fields/lib/PropertyFieldColorPickerMini';\r\nimport { PropertyFieldFontPicker } from 'sp-client-custom-fields/lib/PropertyFieldFontPicker';\r\nimport { PropertyFieldFontSizePicker } from 'sp-client-custom-fields/lib/PropertyFieldFontSizePicker';\r\n\r\nimport * as $ from 'jquery';\r\nrequire('moment');\r\nrequire('feedek');\r\n\r\nexport default class RssReaderWebPart extends BaseClientSideWebPart<IRssReaderWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    this.guid = this.getGuid();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    var html = '<div id=\"' + this.guid + '\"></div>';\r\n    html += `\r\n<style>\r\n.feedEkList{width:100%; list-style:none outside none;background-color: ${this.properties.backgroundColor}; border:0px solid #D3CAD7; padding:4px 6px; color:#3E3E3E;}\r\n.feedEkList li{border-bottom:1px solid #D3CAD7; padding:5px;}\r\n.feedEkList li:last-child{border-bottom:none;}\r\n.itemTitle a{font-weight:bold; color:${this.properties.fontColor} !important; font-size:${this.properties.fontSize}; font-family:${this.properties.font}; text-decoration:none }\r\n.itemTitle a:hover{ text-decoration:underline }\r\n.itemDate{font-size:11px;color:#AAAAAA;}\r\n</style>\r\n    `;\r\n    this.domElement.innerHTML = html;\r\n\r\n        ($ as any)('#' + this.guid).FeedEk({\r\n            FeedUrl: this.properties.feedUrl,\r\n            MaxCount : this.properties.maxCount,\r\n            ShowDesc : this.properties.showDesc,\r\n            ShowPubDate: this.properties.showPubDate,\r\n            DescCharacterLimit: this.properties.descCharacterLimit,\r\n            TitleLinkTarget: this.properties.titleLinkTarget,\r\n            DateFormat: this.properties.dateFormat,\r\n            DateFormatLang: this.properties.dateFormatLang\r\n        });\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: true,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField('feedUrl', {\r\n                  label: strings.feedUrl\r\n                }),\r\n                PropertyPaneSlider('maxCount', {\r\n                  label: strings.maxCount,\r\n                  min: 1,\r\n                  max: 100,\r\n                  step: 1\r\n                }),\r\n                PropertyPaneToggle('showPubDate', {\r\n                  label: strings.showPubDate\r\n                }),\r\n                PropertyPaneToggle('showDesc', {\r\n                  label: strings.showDesc\r\n                }),\r\n                PropertyPaneSlider('descCharacterLimit', {\r\n                  label: strings.descCharacterLimit,\r\n                  min: 1,\r\n                  max: 500,\r\n                  step: 1\r\n                }),\r\n                PropertyPaneTextField('titleLinkTarget', {\r\n                  label: strings.titleLinkTarget\r\n                }),\r\n                PropertyPaneTextField('dateFormat', {\r\n                  label: strings.dateFormat\r\n                }),\r\n                PropertyPaneTextField('dateFormatLang', {\r\n                  label: strings.dateFormatLang\r\n                })\r\n              ]\r\n            },\r\n            {\r\n              groupName: strings.LayoutGroupName,\r\n              groupFields: [\r\n                PropertyFieldFontPicker('font', {\r\n                  label: strings.font,\r\n                  initialValue: this.properties.font,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'rssReaderFontField'\r\n                }),\r\n                PropertyFieldFontSizePicker('fontSize', {\r\n                  label: strings.fontSize,\r\n                  initialValue: this.properties.fontSize,\r\n                  usePixels: true,\r\n                  preview: true,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'rssReaderFontSizeField'\r\n                }),\r\n                PropertyFieldColorPickerMini('fontColor', {\r\n                  label: strings.fontColor,\r\n                  initialColor: this.properties.fontColor,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'rssReaderFontColorField'\r\n                }),\r\n                PropertyFieldColorPickerMini('backgroundColor', {\r\n                  label: strings.backgroundColor,\r\n                  initialColor: this.properties.backgroundColor,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'rssReaderBgColorField'\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}