{"version":3,"sources":["webparts/arcText/ArcTextWebPart.ts"],"names":[],"mappings":"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","file":"webparts/arcText/ArcTextWebPart.js","sourcesContent":["/**\r\n * @file ArcTextWebPart.ts\r\n * ArcText JQuery Plugin adaptation as a web part for the SharePoint Framework (SPfx)\r\n *\r\n * @copyright 2016 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  IWebPartContext,\r\n  PropertyPaneTextField,\r\n  PropertyPaneToggle,\r\n  PropertyPaneSlider,\r\n  PropertyPaneDropdown\r\n} from '@microsoft/sp-webpart-base';\r\nimport { Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'arcTextStrings';\r\nimport { IArcTextWebPartProps } from './IArcTextWebPartProps';\r\n\r\n//Loads the property pane custom fields\r\nimport { PropertyFieldColorPicker } from 'sp-client-custom-fields/lib/PropertyFieldColorPicker';\r\nimport { PropertyFieldFontPicker } from 'sp-client-custom-fields/lib/PropertyFieldFontPicker';\r\nimport { PropertyFieldFontSizePicker } from 'sp-client-custom-fields/lib/PropertyFieldFontSizePicker';\r\n\r\n//Loads JQuery & Arctext Javascript libraries\r\nimport * as $ from 'jquery';\r\nrequire('arctext');\r\n\r\n/**\r\n * @class\r\n * ArcText Web Part\r\n */\r\nexport default class ArcTextWebPart extends BaseClientSideWebPart<IArcTextWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    //Inits the WebParts GUID\r\n    this.guid = this.getGuid();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n    this.renderContents = this.renderContents.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n    //Defines the main DIV container with output HTML code\r\n    this.domElement.innerHTML = `<div style='text-align: ${this.properties.align}; font-family: ${this.properties.font}; font-size: ${this.properties.size}; color: ${this.properties.color};'><h3 class=\"arcText\" id=\"${this.guid + '-arc'}\">${this.properties.text}</h3></div>`;\r\n    this.renderContents();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders JavaScript JQuery calls\r\n   */\r\n  private renderContents(): void {\r\n    ($ as any)('#' + this.guid + '-arc').arctext({\r\n        radius: this.properties.radius,\r\n        rotate: this.properties.rotateLetters,\r\n        dir: this.properties.reverse === true ? -1 : 1\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: true,\r\n          groups: [\r\n            {\r\n              groupName: strings.EffectGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField('text', {\r\n                  label: strings.TextFieldLabel,\r\n                  multiline: false\r\n                }),\r\n                PropertyPaneSlider('radius', {\r\n                  label: strings.RadiusFieldLabel,\r\n                  min: 1,\r\n                  max: 1500,\r\n                  step: 1,\r\n                  showValue: true\r\n                }),\r\n                PropertyPaneToggle('rotateLetters', {\r\n                  label: strings.RotateLetterFieldLabel\r\n                }),\r\n                PropertyPaneToggle('reverse', {\r\n                  label: strings.DirectionFieldLabel\r\n                }),\r\n                PropertyPaneDropdown('align', {\r\n                  label: strings.AlignFieldLabel,\r\n                  options: [\r\n                    { key: 'left', text: strings.AlignLeft },\r\n                    { key: 'center', text: strings.AlignCenter },\r\n                    { key: 'right', text: strings.AlignRight }\r\n                  ]\r\n                })\r\n              ]\r\n            },\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyFieldFontPicker('font', {\r\n                  label: strings.FontFieldLabel,\r\n                  useSafeFont: true,\r\n                  previewFonts: true,\r\n                  initialValue: this.properties.font,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: \"arcTextFontField\"\r\n                }),\r\n                PropertyFieldFontSizePicker('size', {\r\n                  label: strings.FontSizeFieldLabel,\r\n                  usePixels: true,\r\n                  preview: true,\r\n                  initialValue: this.properties.size,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: \"arcTextFontSizeField\"\r\n                }),\r\n                PropertyFieldColorPicker('color', {\r\n                  label: strings.ColorFieldLabel,\r\n                  initialColor: this.properties.color,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: \"arcTextColorField\"\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}