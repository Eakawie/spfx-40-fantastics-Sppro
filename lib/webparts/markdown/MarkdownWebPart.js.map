{"version":3,"sources":["webparts/markdown/MarkdownWebPart.ts"],"names":[],"mappings":"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","file":"webparts/markdown/MarkdownWebPart.js","sourcesContent":["/**\r\n * @file\r\n * Markdown Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  IWebPartContext,\r\n  PropertyPaneToggle\r\n} from '@microsoft/sp-webpart-base';\r\nimport { DisplayMode, Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'MarkdownStrings';\r\nimport { IMarkdownWebPartProps } from './IMarkdownWebPartProps';\r\n\r\n//Loads external CSS\r\nrequire('../../css/simplemde/simplemde.min.scss');\r\n\r\n//Loads exrnal JS Libs\r\nvar SimpleMDE: any = require('simplemde');\r\nvar showdown: any = require('showdown');\r\n\r\n/**\r\n * @class\r\n * Markdown Web Part.\r\n */\r\nexport default class MarkdownWebPart extends BaseClientSideWebPart<IMarkdownWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    this.guid = this.getGuid();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    if (this.displayMode == DisplayMode.Edit) {\r\n      //Edit mode: build a rich text area specialized in MD edition\r\n\r\n      //Creates a textarea container\r\n      var html = '';\r\n      html += \"<textarea id='\" + this.guid + \"-editor'>\" + this.properties.text + \"</textarea>\";\r\n      this.domElement.innerHTML = html;\r\n\r\n        var simplemde;\r\n        if (this.properties.toolbar === false) {\r\n          if (this.properties.status === false) {\r\n            //Creates editor without status bar & toolbar\r\n            simplemde = new SimpleMDE({\r\n              element: document.getElementById(this.guid + \"-editor\"),\r\n              toolbar: this.properties.toolbar,\r\n              toolbarTips: this.properties.toolbarTips,\r\n              status: this.properties.status,\r\n              spellChecker: this.properties.spellChecker\r\n            });\r\n          }\r\n          else {\r\n            //Creates editor with status bar & without toolbar\r\n            simplemde = new SimpleMDE({\r\n              element: document.getElementById(this.guid + \"-editor\"),\r\n              toolbar: this.properties.toolbar,\r\n              toolbarTips: this.properties.toolbarTips,\r\n              spellChecker: this.properties.spellChecker\r\n            });\r\n          }\r\n        }\r\n        else {\r\n          if (this.properties.status === false) {\r\n            //Creates editor without status bar & with toolbar\r\n            simplemde = new SimpleMDE({\r\n              element: document.getElementById(this.guid + \"-editor\"),\r\n              toolbarTips: this.properties.toolbarTips,\r\n              status: this.properties.status,\r\n              spellChecker: this.properties.spellChecker\r\n            });\r\n          }\r\n          else {\r\n            simplemde = new SimpleMDE({\r\n              //Creates editor with status bar & with toolbar\r\n              element: document.getElementById(this.guid + \"-editor\"),\r\n              toolbarTips: this.properties.toolbarTips,\r\n              spellChecker: this.properties.spellChecker\r\n            });\r\n          }\r\n        }\r\n        simplemde.codemirror.on(\"change\", function(){\r\n          //Function executed when the text change in rich editor\r\n          this.properties.text = simplemde.value();\r\n        }.bind(this));\r\n    }\r\n    else {\r\n      //Read Mode\r\n      //Inits the converter\r\n      var converter = new showdown.Converter();\r\n      converter.setOption('tables', true);\r\n      converter.setOption('tasklists', true);\r\n      converter.setOption('smoothLivePreview', true);\r\n      converter.setOption('encodeEmails', true);\r\n      //Converts MD to HTML\r\n      this.domElement.innerHTML = converter.makeHtml(this.properties.text);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: false,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneToggle('toolbar', {\r\n                  label: strings.Toolbar,\r\n                }),\r\n                PropertyPaneToggle('toolbarTips', {\r\n                  label: strings.ToolbarTips,\r\n                }),\r\n                PropertyPaneToggle('status', {\r\n                  label: strings.Status,\r\n                }),\r\n                PropertyPaneToggle('spellChecker', {\r\n                  label: strings.SpellChecker,\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}