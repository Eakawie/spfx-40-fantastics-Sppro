{"version":3,"sources":["webparts/messageBar/MessageBarWebPart.ts"],"names":[],"mappings":"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","file":"webparts/messageBar/MessageBarWebPart.js","sourcesContent":["/**\r\n * @file\r\n * Message Bar Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneToggle,\r\n  IWebPartContext\r\n} from '@microsoft/sp-webpart-base';\r\nimport { Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'MessageBarStrings';\r\nimport { IMessageBarWebPartProps } from './IMessageBarWebPartProps';\r\n\r\n//Imports property pane custom fields\r\nimport { PropertyFieldColorPickerMini } from 'sp-client-custom-fields/lib/PropertyFieldColorPickerMini';\r\nimport { PropertyFieldFontPicker } from 'sp-client-custom-fields/lib/PropertyFieldFontPicker';\r\nimport { PropertyFieldFontSizePicker } from 'sp-client-custom-fields/lib/PropertyFieldFontSizePicker';\r\nimport { PropertyFieldIconPicker } from 'sp-client-custom-fields/lib/PropertyFieldIconPicker';\r\nimport { PropertyFieldRichTextBox } from 'sp-client-custom-fields/lib/PropertyFieldRichTextBox';\r\n\r\nexport default class MessageBarWebPart extends BaseClientSideWebPart<IMessageBarWebPartProps> {\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    var style = \"style='\";\r\n    if (this.properties.font != null)\r\n      style += \"font-family: \" + this.properties.font + ';';\r\n    if (this.properties.fontSize != null)\r\n      style += \"font-size: \" + this.properties.fontSize + ';';\r\n    if (this.properties.fontColor != null)\r\n      style += \"color: \" + this.properties.fontColor  + ';';\r\n    if (this.properties.backgroundColor != null)\r\n      style += \"background-color: \" + this.properties.backgroundColor  + ';';\r\n    style += \"'\";\r\n\r\n    var html = '';\r\n    if (this.properties.enabled != false) {\r\n      html += '<div ' + style + '>';\r\n      html += ' <div class=\"ms-MessageBar-content\">';\r\n      html += '   <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr>';\r\n      html += '   <td align=\"top\" valign=\"middle\"><div class=\"ms-MessageBar-icon\" style=\"padding-left: 10px;\">';\r\n      html += '     <i class=\"ms-Icon ' + this.properties.icon + '\" style=\"font-size: ' + this.properties.fontSize + '\"></i>';\r\n      html += '   </div></td>';\r\n      html += '   <td align=\"top\" valign=\"middle\"><div class=\"\">';\r\n      html += this.properties.text;\r\n      html += '   </div></td>';\r\n      html += '   </tr></table>';\r\n      html += '  </div>';\r\n      html += '</div>';\r\n    }\r\n    this.domElement.innerHTML = html;\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: true,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneToggle('enabled', {\r\n                  label: strings.Enabled\r\n                }),\r\n                PropertyFieldIconPicker('icon', {\r\n                  label: strings.Icon,\r\n                  initialValue: this.properties.icon,\r\n                  orderAlphabetical: true,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'messageBarIconField'\r\n                }),\r\n                PropertyFieldRichTextBox('text', {\r\n                  label: strings.Text,\r\n                  initialValue: this.properties.text,\r\n                  inline: false,\r\n                  minHeight: 100,\r\n                  mode: 'basic',\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'messageBarRichTextBoxField'\r\n                })\r\n              ]\r\n            },\r\n            {\r\n              groupName: strings.LayoutGroupName,\r\n              groupFields: [\r\n                PropertyFieldFontPicker('font', {\r\n                  label: strings.Font,\r\n                  useSafeFont: true,\r\n                  previewFonts: true,\r\n                  initialValue: this.properties.font,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'messageBarFontField'\r\n                }),\r\n                PropertyFieldFontSizePicker('fontSize', {\r\n                  label: strings.FontSize,\r\n                  usePixels: true,\r\n                  preview: true,\r\n                  initialValue: this.properties.fontSize,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'messageBarFontSizeField'\r\n                }),\r\n                PropertyFieldColorPickerMini('fontColor', {\r\n                  label: strings.FontColor,\r\n                  initialColor: this.properties.fontColor,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'messageBarFontColorField'\r\n                }),\r\n                PropertyFieldColorPickerMini('backgroundColor', {\r\n                  label: strings.BackgroundColor,\r\n                  initialColor: this.properties.backgroundColor,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'messageBarBgColorField'\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}