{"version":3,"sources":["webparts/verticalTimeline/VerticalTimelineWebPart.ts"],"names":[],"mappings":"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","file":"webparts/verticalTimeline/VerticalTimelineWebPart.js","sourcesContent":["/**\r\n * @file\r\n * Vertical Timeline Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  IWebPartContext\r\n} from '@microsoft/sp-webpart-base';\r\nimport { Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'VerticalTimelineStrings';\r\nimport { IVerticalTimelineWebPartProps } from './IVerticalTimelineWebPartProps';\r\nimport { SPCalendarService } from './SPCalendarService';\r\nimport { ISPListItem } from './ISPList';\r\n\r\n//Imports property pane custom fields\r\nimport { PropertyFieldSPListQuery, PropertyFieldSPListQueryOrderBy } from 'sp-client-custom-fields/lib/PropertyFieldSPListQuery';\r\nimport { PropertyFieldIconPicker } from 'sp-client-custom-fields/lib/PropertyFieldIconPicker';\r\nimport { PropertyFieldColorPickerMini } from 'sp-client-custom-fields/lib/PropertyFieldColorPickerMini';\r\n\r\nimport * as $ from 'jquery';\r\n\r\nexport default class VerticalTimelineWebPart extends BaseClientSideWebPart<IVerticalTimelineWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    this.guid = this.getGuid();\r\n    this.timelineAnimate = this.timelineAnimate.bind(this);\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    if (this.properties.query == null || this.properties.query == '') {\r\n      //Display select a list message\r\n      this.domElement.innerHTML = `\r\n        <div class=\"ms-MessageBar\">\r\n          <div class=\"ms-MessageBar-content\">\r\n            <div class=\"ms-MessageBar-icon\">\r\n              <i class=\"ms-Icon ms-Icon--Info\"></i>\r\n            </div>\r\n            <div class=\"ms-MessageBar-text\">\r\n              ${strings.ErrorSelectList}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      `;\r\n      return;\r\n    }\r\n\r\n    var html = '';\r\n\r\n    html += `\r\n<style>\r\n.bg-primary, .bg-success, .bg-info, .bg-warning, .bg-danger, .bg-muted {\r\n  color: white; height: 40px;\r\n  }\r\n  .bg-primary .page-header, .bg-success .page-header, .bg-info .page-header, .bg-warning .page-header, .bg-danger .page-header, .bg-muted .page-header {\r\n    color: white; }\r\n\r\n.bg-primary {\r\n  background-color: #32b9b1; }\r\n\r\n.bg-success {\r\n  background-color: #51be38; }\r\n\r\n.bg-info {\r\n  background-color: #5bc0de; }\r\n\r\n.bg-warning {\r\n  background-color: #ef9544; }\r\n\r\n.bg-danger {\r\n  background-color: #f05a5b; }\r\n\r\n.bg-muted {\r\n  background-color: #bbbbbb; }\r\n\r\n.panel {\r\n  border: 0; }\r\n  .panel .panel-body {\r\n    padding: 20px; }\r\n  .panel-body {\r\n    background-color: ${this.properties.backgroundColor};\r\n    color: ${this.properties.color}\r\n  }\r\n\r\n.panel-heading .panel-toggle {\r\n  background: #f9fafa; }\r\n.panel-heading .panel-title {\r\n  font-size: 18px; }\r\n\r\n.timeline {\r\n  list-style: none;\r\n  position: relative;\r\n  max-width: 1200px;\r\n  padding: 20px;\r\n  margin: 0 auto;\r\n  overflow: hidden; }\r\n  .timeline:after {\r\n    content: \"\";\r\n    position: absolute;\r\n    top: 0;\r\n    left: 50%;\r\n    margin-left: -2px;\r\n    background-color: rgba(0, 0, 0, 0.2);\r\n    height: 100%;\r\n    width: 4px;\r\n    border-radius: 2px;\r\n    display: block; }\r\n  .timeline .timeline-row {\r\n    padding-left: 50%;\r\n    position: relative;\r\n    z-index: 10; }\r\n    .timeline .timeline-row .timeline-time {\r\n      position: absolute;\r\n      right: 50%;\r\n      top: 31px;\r\n      text-align: right;\r\n      margin-right: 40px;\r\n      font-size: 16px;\r\n      line-height: 1.3;\r\n      font-weight: 600; }\r\n      .timeline .timeline-row .timeline-time small {\r\n        display: block;\r\n        color: #999999;\r\n        text-transform: uppercase;\r\n        opacity: 0.75;\r\n        font-size: 11px;\r\n        font-weight: 400; }\r\n    .timeline .timeline-row .timeline-icon {\r\n      position: absolute;\r\n      top: 30px;\r\n      left: 50%;\r\n      margin-left: -20px;\r\n      width: 40px;\r\n      height: 40px;\r\n      border-radius: 50%;\r\n      background-color: #eeeeee;\r\n      text-align: center;\r\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\r\n      overflow: hidden;\r\n      padding: 3px;\r\n      color: white;\r\n      font-size: 14px;\r\n      z-index: 100; }\r\n      .timeline .timeline-row .timeline-icon > div {\r\n        border-radius: 50%;\r\n        line-height: 34px;\r\n        font-size: 16px; }\r\n    .timeline .timeline-row .timeline-content {\r\n      margin-left: 40px;\r\n      position: relative;\r\n      background-color: white;\r\n      color: #333333; }\r\n      .timeline .timeline-row .timeline-content:after {\r\n        content: \"\";\r\n        position: absolute;\r\n        top: 48px;\r\n        left: -41px;\r\n        height: 4px;\r\n        width: 40px;\r\n        background-color: rgba(0, 0, 0, 0.2);\r\n        z-index: -1; }\r\n      .timeline .timeline-row .timeline-content .panel-body {\r\n        padding: 15px 15px 2px;\r\n        position: relative;\r\n        z-index: 10; }\r\n      .timeline .timeline-row .timeline-content h2 {\r\n        font-size: 22px;\r\n        margin-bottom: 12px;\r\n        margin-top: 0;\r\n        line-height: 1.2; }\r\n      .timeline .timeline-row .timeline-content p {\r\n        margin-bottom: 15px; }\r\n      .timeline .timeline-row .timeline-content img {\r\n        margin-bottom: 15px; }\r\n      .timeline .timeline-row .timeline-content blockquote {\r\n        border-color: #eeeeee; }\r\n        .timeline .timeline-row .timeline-content blockquote footer, .timeline .timeline-row .timeline-content blockquote small, .timeline .timeline-row .timeline-content blockquote .small, .timeline .timeline-row .timeline-content blockquote.blockquote-reverse footer, .timeline .timeline-row .timeline-content blockquote.blockquote-reverse small, .timeline .timeline-row .timeline-content blockquote.blockquote-reverse .small {\r\n          color: #999999; }\r\n      .timeline .timeline-row .timeline-content .video-container {\r\n        position: relative;\r\n        padding-bottom: 56.25%;\r\n        padding-top: 30px;\r\n        height: 0;\r\n        margin-bottom: 15px;\r\n        overflow: hidden; }\r\n        .timeline .timeline-row .timeline-content .video-container iframe, .timeline .timeline-row .timeline-content .video-container object, .timeline .timeline-row .timeline-content .video-container embed {\r\n          position: absolute;\r\n          top: 0;\r\n          left: 0;\r\n          width: 100%;\r\n          height: 100%; }\r\n    .timeline .timeline-row:nth-child(odd) {\r\n      padding-left: 0;\r\n      padding-right: 50%; }\r\n      .timeline .timeline-row:nth-child(odd) .timeline-time {\r\n        right: auto;\r\n        left: 50%;\r\n        text-align: left;\r\n        margin-right: 0;\r\n        margin-left: 40px; }\r\n      .timeline .timeline-row:nth-child(odd) .timeline-content {\r\n        margin-right: 40px;\r\n        margin-left: 0; }\r\n        .timeline .timeline-row:nth-child(odd) .timeline-content:after {\r\n          left: auto;\r\n          right: -41px; }\r\n  .timeline.animated .timeline-row .timeline-content {\r\n    opacity: 0;\r\n    left: 20px;\r\n    -webkit-transition: all 0.8s;\r\n    -moz-transition: all 0.8s;\r\n    transition: all 0.8s; }\r\n  .timeline.animated .timeline-row:nth-child(odd) .timeline-content {\r\n    left: -20px; }\r\n  .timeline.animated .timeline-row.active .timeline-content {\r\n    opacity: 1;\r\n    left: 0; }\r\n  .timeline.animated .timeline-row.active:nth-child(odd) .timeline-content {\r\n    left: 0; }\r\n\r\n@media (max-width: 1200px) {\r\n  .timeline {\r\n    padding: 15px 10px; }\r\n    .timeline:after {\r\n      left: 28px; }\r\n    .timeline .timeline-row {\r\n      padding-left: 0;\r\n      margin-bottom: 16px; }\r\n      .timeline .timeline-row .timeline-time {\r\n        position: relative;\r\n        right: auto;\r\n        top: 0;\r\n        text-align: left;\r\n        margin: 0 0 6px 56px; }\r\n        .timeline .timeline-row .timeline-time strong {\r\n          display: inline-block;\r\n          margin-right: 10px; }\r\n      .timeline .timeline-row .timeline-icon {\r\n        top: 52px;\r\n        left: -2px;\r\n        margin-left: 0; }\r\n      .timeline .timeline-row .timeline-content {\r\n        margin-left: 56px;\r\n        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\r\n        position: relative; }\r\n        .timeline .timeline-row .timeline-content:after {\r\n          right: auto !important;\r\n          left: -20px !important;\r\n          top: 32px; }\r\n      .timeline .timeline-row:nth-child(odd) {\r\n        padding-right: 0; }\r\n        .timeline .timeline-row:nth-child(odd) .timeline-time {\r\n          position: relative;\r\n          right: auto;\r\n          left: auto;\r\n          top: 0;\r\n          text-align: left;\r\n          margin: 0 0 6px 56px; }\r\n        .timeline .timeline-row:nth-child(odd) .timeline-content {\r\n          margin-right: 0;\r\n          margin-left: 55px; }\r\n    .timeline.animated .timeline-row:nth-child(odd) .timeline-content {\r\n      left: 20px; }\r\n    .timeline.animated .timeline-row.active:nth-child(odd) .timeline-content {\r\n      left: 0; } }\r\n\r\n</style>\r\n    `;\r\n      this.domElement.innerHTML = html;\r\n\r\n      const picturesListService: SPCalendarService = new SPCalendarService(this.properties, this.context);\r\n      //Load the list of pictures from the current lib\r\n      var queryUrl = this.properties.query;\r\n\r\n      picturesListService.getItems(queryUrl).then((response) => {\r\n\r\n          var responseVal = response.value;\r\n\r\n          if (responseVal == null || responseVal.length == 0) {\r\n            this.domElement.innerHTML = `\r\n              <div class=\"ms-MessageBar ms-MessageBar--error\">\r\n                <div class=\"ms-MessageBar-content\">\r\n                  <div class=\"ms-MessageBar-icon\">\r\n                    <i class=\"ms-Icon ms-Icon--ErrorBadge\"></i>\r\n                  </div>\r\n                  <div class=\"ms-MessageBar-text\">\r\n                    ${strings.ErrorNoItems}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            `;\r\n            return;\r\n          }\r\n\r\n          var outputHtml: string = '';\r\n          outputHtml += `\r\n              <div class=\"timeline animated\">\r\n          `;\r\n\r\n          responseVal.map((object:ISPListItem, i:number) => {\r\n            //Render the item\r\n            var eventDate = object.EventDate;\r\n            var dateEvent = new Date(eventDate);\r\n            outputHtml += `\r\n                 <div class=\"timeline-row\">\r\n                  <div class=\"timeline-time\">\r\n                    <small>${dateEvent.toDateString()}</small>${dateEvent.toLocaleTimeString()}\r\n                  </div>\r\n                  <div class=\"timeline-icon\">\r\n                    <div class=\"bg-primary\">\r\n                      <i style=\"font-size: 20px;padding-top: 2px;\" class=\"ms-Icon ${this.properties.icon}\" aria-hidden=\"true\"></i>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"panel timeline-content\">\r\n                    <div class=\"panel-body\">\r\n                      <h2>\r\n                        ${object.Title}\r\n                      </h2>\r\n                      <p>\r\n                        ${object.Description}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n            `;\r\n          });\r\n          outputHtml += '</div>';\r\n          this.domElement.innerHTML += outputHtml;\r\n          this.timelineAnimate();\r\n      });\r\n\r\n    $('#pageContent').scroll(() => {\r\n      this.timelineAnimate();\r\n    });\r\n\r\n  }\r\n\r\n  private timelineAnimate(): void {\r\n    $(\".timeline.animated .timeline-row\").each(function(i) {\r\n        var bottom_of_object, bottom_of_window;\r\n        bottom_of_object = $(this).position().top + $(this).outerHeight();\r\n        bottom_of_window = $('#pageContent').scrollTop() + $('#pageContent').height();\r\n        if (bottom_of_window > bottom_of_object) {\r\n          return $(this).addClass(\"active\");\r\n        }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: true,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                 PropertyFieldSPListQuery('query', {\r\n                  label: '',\r\n                  query: this.properties.query,\r\n                  includeHidden: false,\r\n                  baseTemplate: 106,\r\n                  orderBy: PropertyFieldSPListQueryOrderBy.Title,\r\n                  showOrderBy: true,\r\n                  showMax: true,\r\n                  showFilters: true,\r\n                  max: 100,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  context: this.context,\r\n                  properties: this.properties,\r\n                  key: 'verticalTimelineQueryField'\r\n                })\r\n              ]\r\n            },\r\n            {\r\n              groupName: strings.LayoutGroupName,\r\n              groupFields: [\r\n                 PropertyFieldIconPicker('icon', {\r\n                  label: strings.icon,\r\n                  initialValue: this.properties.icon,\r\n                  orderAlphabetical: true,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'verticalTimelineIconField'\r\n                }),\r\n                PropertyFieldColorPickerMini('color', {\r\n                  label: strings.color,\r\n                  initialColor: this.properties.color,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'verticalTimelineColorField'\r\n                }),\r\n                PropertyFieldColorPickerMini('backgroundColor', {\r\n                  label: strings.backgroundColor,\r\n                  initialColor: this.properties.backgroundColor,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'verticalTimelineBgColorField'\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}