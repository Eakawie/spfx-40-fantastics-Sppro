{"version":3,"sources":["webparts/simplePoll/SimplePollWebPart.ts"],"names":[],"mappings":"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","file":"webparts/simplePoll/SimplePollWebPart.js","sourcesContent":["/**\r\n * @file SimplePollWebPart.ts\r\n * Simple Poll Web part for SharePoint Framework SPFx\r\n *\r\n * @copyright 2016 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport * as React from 'react';\r\nimport * as ReactDom from 'react-dom';\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneDropdown,\r\n  PropertyPaneToggle,\r\n  IWebPartContext\r\n} from '@microsoft/sp-webpart-base';\r\nimport { Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'SimplePollStrings';\r\nimport { ISimplePollWebPartProps } from './ISimplePollWebPartProps';\r\nimport SimplePollWebPartHost from './components/SimplePollWebPartHost';\r\n\r\n//Imports property pane custom fields\r\nimport { PropertyFieldColorPickerMini } from 'sp-client-custom-fields/lib/PropertyFieldColorPickerMini';\r\nimport { PropertyFieldFontPicker } from 'sp-client-custom-fields/lib/PropertyFieldFontPicker';\r\nimport { PropertyFieldFontSizePicker } from 'sp-client-custom-fields/lib/PropertyFieldFontSizePicker';\r\nimport { PropertyFieldSPListPicker, PropertyFieldSPListPickerOrderBy } from 'sp-client-custom-fields/lib/PropertyFieldSPListPicker';\r\n\r\nexport default class SimplePollWebPart extends BaseClientSideWebPart<ISimplePollWebPartProps> {\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    //Constructs the react element code to JSX\r\n    const element: React.ReactElement<ISimplePollWebPartProps> = React.createElement(SimplePollWebPartHost, {\r\n      surveyList: this.properties.surveyList,\r\n      font: this.properties.font,\r\n      size: this.properties.size,\r\n      color: this.properties.color,\r\n      chartType: this.properties.chartType,\r\n      forceVoteToViewResults: this.properties.forceVoteToViewResults,\r\n      context: this.context\r\n    });\r\n\r\n    //Render the dom\r\n    ReactDom.render(element, this.domElement);\r\n\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: true,\r\n          groups: [\r\n            {\r\n              groupName: strings.EffectGroupName,\r\n              groupFields: [\r\n                PropertyFieldSPListPicker('surveyList', {\r\n                  label: strings.surveyList,\r\n                  selectedList: this.properties.surveyList,\r\n                  includeHidden: false,\r\n                  baseTemplate: 102,\r\n                  orderBy: PropertyFieldSPListPickerOrderBy.Title,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  context: this.context,\r\n                  properties: this.properties,\r\n                  key: 'simplePollListField'\r\n                }),\r\n                PropertyPaneDropdown('chartType', {\r\n                  label: strings.chartType,\r\n                  options: [\r\n                    {key: 'pie', text: 'Pie chart'},\r\n                    {key: 'horizontalBar', text: 'Bar chart'}\r\n                  ]\r\n                }),\r\n                PropertyPaneToggle('forceVoteToViewResults', {\r\n                  label: strings.forceVoteToViewResults\r\n                })\r\n              ]\r\n            },\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyFieldFontPicker('font', {\r\n                  label: strings.FontFieldLabel,\r\n                  useSafeFont: true,\r\n                  previewFonts: true,\r\n                  initialValue: this.properties.font,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'simplePollFontField'\r\n                }),\r\n                PropertyFieldFontSizePicker('size', {\r\n                  label: strings.FontSizeFieldLabel,\r\n                  usePixels: true,\r\n                  preview: true,\r\n                  initialValue: this.properties.size,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'simplePollSizeField'\r\n                }),\r\n                PropertyFieldColorPickerMini('color', {\r\n                  label: strings.ColorFieldLabel,\r\n                  initialColor: this.properties.color,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: 'simplePollColorField'\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}