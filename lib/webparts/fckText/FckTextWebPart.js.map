{"version":3,"sources":["webparts/fckText/FckTextWebPart.ts"],"names":[],"mappings":"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","file":"webparts/fckText/FckTextWebPart.js","sourcesContent":["/**\r\n * @file\r\n * FckText Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  IWebPartContext,\r\n  PropertyPaneToggle\r\n} from '@microsoft/sp-webpart-base';\r\nimport { DisplayMode, Version } from '@microsoft/sp-core-library';\r\nimport { Environment, EnvironmentType } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'fckTextStrings';\r\nimport { IFckTextWebPartProps } from './IFckTextWebPartProps';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\n\r\nexport default class FckTextWebPart extends BaseClientSideWebPart<IFckTextWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    this.guid = this.getGuid();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    if (Environment.type === EnvironmentType.ClassicSharePoint) {\r\n      var errorHtml = '';\r\n      errorHtml += '<div style=\"color: red;\">';\r\n      errorHtml += '<div style=\"display:inline-block; vertical-align: middle;\"><i class=\"ms-Icon ms-Icon--Error\" style=\"font-size: 20px\"></i></div>';\r\n      errorHtml += '<div style=\"display:inline-block; vertical-align: middle;margin-left:7px;\"><span>';\r\n      errorHtml += strings.ErrorClassicSharePoint;\r\n      errorHtml += '</span></div>';\r\n      errorHtml += '</div>';\r\n      this.domElement.innerHTML = errorHtml;\r\n      return;\r\n    }\r\n\r\n\r\n    if (this.displayMode == DisplayMode.Edit) {\r\n      //Edit mode\r\n      var html = '';\r\n      html += \"<textarea name='\" + this.guid + \"-editor' id='\" + this.guid + \"-editor'>\" + this.properties.text + \"</textarea>\";\r\n      this.domElement.innerHTML = html;\r\n\r\n      var ckEditorCdn: string = '//cdn.ckeditor.com/4.6.2/full/ckeditor.js';\r\n      SPComponentLoader.loadScript(ckEditorCdn, { globalExportsName: 'CKEDITOR' }).then((CKEDITOR: any): void => {\r\n        if (this.properties.inline == null || this.properties.inline === false)\r\n          CKEDITOR.replace( this.guid + '-editor', {\r\n              skin: 'moono-lisa,//cdn.ckeditor.com/4.6.2/full-all/skins/moono-lisa/'\r\n          }  );\r\n        else\r\n          CKEDITOR.inline( this.guid + '-editor', {\r\n              skin: 'moono-lisa,//cdn.ckeditor.com/4.6.2/full-all/skins/moono-lisa/'\r\n          }   );\r\n\r\n        for (var i in CKEDITOR.instances) {\r\n          CKEDITOR.instances[i].on('change', (elm?, val?) =>\r\n          {\r\n            //CKEDITOR.instances[i].updateElement();\r\n            elm.sender.updateElement();\r\n            var value = ((document.getElementById(this.guid + '-editor')) as any).value;\r\n            if (this.onPropertyPaneFieldChanged && value != null) {\r\n              this.properties.text = value;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      //Read Mode\r\n      this.domElement.innerHTML = this.properties.text;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: false,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneToggle('inline', {\r\n                  label: strings.Inline,\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}